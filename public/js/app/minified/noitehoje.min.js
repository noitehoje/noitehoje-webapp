(function(){var f,e,h=function(a,b){return function(){return a.apply(b,arguments)}};window.NOITEHOJE={webApp:{apiKey:"crEjew8r",version:"1.0"}};NOITEHOJE.webApp.googleMaps=function(){return{CITIES_LOCATIONS:{"porto-alegre":new google.maps.LatLng(-30.027704,-51.228735),curitiba:new google.maps.LatLng(-25.428356,-49.273251),"rio-de-janeiro":new google.maps.LatLng(-22.903539,-43.209587),"sao-paulo":new google.maps.LatLng(-23.548943,-46.638818),"belo-horizonte":new google.maps.LatLng(-19.919068,-43.938575),
florianopolis:new google.maps.LatLng(-27.596904,-48.549454)},showMarker:{image:new google.maps.MarkerImage("/images/app/show-map-icon.png",new google.maps.Size(48,48),new google.maps.Point(0,0),new google.maps.Point(24,48)),shadow:new google.maps.MarkerImage("/images/app/show-map-icon-shadow.png",new google.maps.Size(76,48),new google.maps.Point(0,0),new google.maps.Point(24,48)),selected:new google.maps.MarkerImage("/images/app/show-map-icon-selected.png",new google.maps.Size(48,48),new google.maps.Point(0,
0),new google.maps.Point(24,48)),shape:{coord:[43,0,44,1,44,2,44,3,44,4,44,5,44,6,44,7,44,8,44,9,44,10,44,11,44,12,44,13,44,14,44,15,44,16,44,17,44,18,44,19,44,20,44,21,44,22,44,23,44,24,44,25,44,26,44,27,44,28,44,29,44,30,44,31,44,32,44,33,44,34,44,35,44,36,44,37,44,38,44,39,44,40,43,41,29,42,28,43,27,44,26,45,25,46,24,47,23,47,22,46,21,45,20,44,19,43,18,42,4,41,3,40,3,39,3,38,3,37,3,36,3,35,3,34,3,33,3,32,3,31,3,30,3,29,3,28,3,27,3,26,3,25,3,24,3,23,3,22,3,21,3,20,3,19,3,18,3,17,3,16,3,15,3,14,
3,13,3,12,3,11,3,10,3,9,3,8,3,7,3,6,3,5,2,4,2,3,3,2,3,1,4,0,43,0],type:"poly"}},partyMarker:{image:new google.maps.MarkerImage("/images/app/party-map-icon.png",new google.maps.Size(48,48),new google.maps.Point(0,0),new google.maps.Point(24,48)),shadow:new google.maps.MarkerImage("/images/app/party-map-icon-shadow.png",new google.maps.Size(76,48),new google.maps.Point(0,0),new google.maps.Point(24,48)),selected:new google.maps.MarkerImage("/images/app/party-map-icon-selected.png",new google.maps.Size(48,
48),new google.maps.Point(0,0),new google.maps.Point(24,48)),shape:{coord:[43,0,44,1,44,2,44,3,44,4,44,5,44,6,44,7,44,8,44,9,44,10,44,11,44,12,44,13,44,14,44,15,44,16,44,17,44,18,44,19,44,20,44,21,44,22,44,23,44,24,44,25,44,26,44,27,44,28,44,29,44,30,44,31,44,32,44,33,44,34,44,35,44,36,44,37,44,38,44,39,44,40,43,41,29,42,28,43,27,44,26,45,25,46,24,47,23,47,22,46,21,45,20,44,19,43,18,42,4,41,3,40,3,39,3,38,3,37,3,36,3,35,3,34,3,33,3,32,3,31,3,30,3,29,3,28,3,27,3,26,3,25,3,24,3,23,3,22,3,21,3,20,3,
19,3,18,3,17,3,16,3,15,3,14,3,13,3,12,3,11,3,10,3,9,3,8,3,7,3,6,3,5,2,4,2,3,3,2,3,1,4,0,43,0],type:"poly"}},mapLoaded:!1,setupMap:function(a){var b,c;b=new google.maps.Map($(a.targetElement)[0],{zoom:14,center:a.mapCenter,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"noitehoje"]}});c=new google.maps.StyledMapType(gmaps_styles,{name:"Mapa Noturno"});b.mapTypes.set("noitehoje",c);b.setMapTypeId("noitehoje");return NOITEHOJE.webApp.googleMaps.createMarkers(b,a.markers,a.markerClickCallback)},
displayEventsMap:function(){$("#listings, .view-ordering, .view-scope").hide();$("#map_wrapper, #map_loader").show();NOITEHOJE.webApp.location.updateLocationWithScope("map");NOITEHOJE.webApp.eventDetails.closeDetailsPanel();if(!NOITEHOJE.webApp.googleMaps.mapLoaded)return $.getJSON(""+location.protocol+"//"+location.host+"/getlocations").success(function(a){return NOITEHOJE.webApp.googleMaps.setupMap({markers:a,mapCenter:NOITEHOJE.webApp.googleMaps.CITIES_LOCATIONS["porto-alegre"],targetElement:"#map_canvas",
markerClickCallback:function(a){return NOITEHOJE.webApp.eventDetails.getEventDetails(a.id).success(function(a){NOITEHOJE.webApp.location.updatePageTitle(a);NOITEHOJE.webApp.eventDetails.openEventDetailsPanel(a);return NOITEHOJE.webApp.location.updateLocationForEventDetails(parseUri(a.permalink).relative)})}})}).complete(function(){$("#map_loader").hide();return NOITEHOJE.webApp.googleMaps.mapLoaded=!0})},unselectCurrentMarker:function(){var a;(a=NOITEHOJE.webApp.googleMaps.selectedMarker)&&a.setIcon(a.markerType.image);
return NOITEHOJE.webApp.googleMaps.selectedMarker=null},createMarkers:function(a,b,c){var d,g,f,e;e=[];g=0;for(f=b.length;g<f;g++)d=b[g],e.push(function(b){var d,e;e=b.type==="show"?NOITEHOJE.webApp.googleMaps.showMarker:NOITEHOJE.webApp.googleMaps.partyMarker;d=new google.maps.Marker({position:new google.maps.LatLng(b.lat,b.lon),map:a,icon:e.image,shadow:e.shadow,shape:e.shape,title:b.title});d.markerType=e;return google.maps.event.addListener(d,"click",function(){NOITEHOJE.webApp.googleMaps.unselectCurrentMarker();
d.setIcon(e.selected);NOITEHOJE.webApp.googleMaps.selectedMarker=d;if(c)return c(b)})}(d));return e}}}();NOITEHOJE.webApp.location=function(){return{basePath:"/",citySlug:"",listingPath:null,listingEventTypes:"Festas e Shows",listingTitle:"Festas e Shows \u00b7 Noite Hoje",titleSeparator:" \u00b7 ",updatePageTitle:function(a){var b;this.listingTitle=""+this.listingEventTypes+this.titleSeparator+"Noite Hoje";a?(b=a.evt_type==="party"?"Festa":"Show",a=""+b+" "+a.title+" em "+a.venue.location.city+this.titleSeparator+
"Noite Hoje"):a=this.listingTitle;return document.title=a},updateLocationWithScope:function(a){a==="any"&&(a="");return History.pushState(null,null,this.basePath+a)},updateLocationForEventDetails:function(a){if(a){if(!this.listingPath)this.listingPath=location.pathname;return History.pushState(null,null,a)}else return a=this.listingPath?this.listingPath:this.basePath,History.pushState(null,null,a),this.listingPath=null}}}();History.Adapter.bind(window,"statechange",function(){return History.getState()});
NOITEHOJE.webApp.search=function(){return{filterList:function(a){var b;b=this.allEvents;b.show();if(a!=="")return b.each(function(){var b,d;b=RegExp(a,"gi");d=$(this);if((""+d.find("h2").text()+" "+d.find("h3").text()).match(b)===null)return d.hide()})},clearFilter:function(){$(".events li").hide();return this.allEvents.show()}}}();$(function(){return $("#search").focus(function(){if($(this).val()==="")return $(this).animate({width:200},500),NOITEHOJE.webApp.search.allEvents=$(".events li:visible")}).blur(function(){return $(this).val()===
""?($(this).animate({width:100},500),NOITEHOJE.webApp.search.clearFilter()):$("#search-loading").show()}).bind("search",function(){return NOITEHOJE.webApp.search.clearFilter()}).keyup(function(a){var b,c;b=this;if(a.keyCode===27)return $(b).val("").blur(),!0;clearTimeout(c);return c=setTimeout(function(){var a;a=$(b).val();return NOITEHOJE.webApp.search.filterList(a)},500)})});NOITEHOJE.webApp.ordering=function(){return{sortAlpha:function(a,b){return $(a).find("h3").first().text()>$(b).find("h3").first().text()?
1:-1}}}();$(function(){var a;NOITEHOJE.webApp.ordering.dateOrderedList=$(".events li");NOITEHOJE.webApp.ordering.nameOrderedList=$(".events li").sort(NOITEHOJE.webApp.ordering.sortAlpha);$(".view-dropdown").click(function(){return $(this).find("ul").show()});$(".change-dropdown a").click(function(){var a,c;c=$(this).text();a=$(this).parents(".view-dropdown");a.find(".selected-item").text(c);a.find("ul").hide();return!1});$(".dd-ordering a").click(function(){var a;a=$(this).text();$(".events li").remove();
a.indexOf("nome")>0?NOITEHOJE.webApp.ordering.nameOrderedList.appendTo(".events"):a.indexOf("data")>0&&NOITEHOJE.webApp.ordering.dateOrderedList.appendTo(".events");return!1});$(".dd-city a").click(function(){var a;a=$(this).attr("id")==="all"?null:$(this).text();f(a);if(Modernizr.localstorage)return localStorage.selectedCity=a});a=Modernizr.localstorage&&localStorage.selectedCity?localStorage.selectedCity:"Porto Alegre";$(".view-dropdown .selected-item").text(a);return f(a)});f=function(a){return $(".events li span.location").each(function(){var b;
b=$(this).parents("li");return a&&$(this).text().toUpperCase()!==a.toUpperCase()?b.hide():b.show()})};NOITEHOJE.webApp.eventDetails=function(){return{WEEKDAYS:["Domingo","Segunda","Ter\u00e7a","Quarta","Quinta","Sexta","S\u00e1bado","Domingo"],MONTHS:["Janeiro","Fevereiro","Mar\u00e7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],formatDateTime:function(a){var b;b=new Date(Date.parse(a.start_date));b=""+this.WEEKDAYS[b.getDay()]+", "+b.getDate()+" de "+this.MONTHS[b.getMonth()];
a.start_time&&(b+=", "+a.start_time);return b},getTwitterIframeSrc:function(a){var b;b=encodeURIComponent(""+document.title);a=encodeURIComponent(a.short_url);return"http://platform0.twitter.com/widgets/tweet_button.html?_=1306124701842&count=horizontal&lang=en&text="+b+"&url="+a+"&via=noitehoje"},refreshFacebookLikeButton:function(a){var b;b=$("#details li.facebook");b.empty().append("<fb:like href='"+a.short_url+"' colorscheme='dark' send='false' width='270' show_faces='false' font='arial'></fb:like>");
return FB.XFBML.parse(b.get(0))},isEventDetailsOpen:function(){return $("#details").attr("data-opened")==="true"},openEventDetailsPanel:function(a,b){var c,d;c=$(".show-event-description");a.description?c.show():c.hide();c=b?$("#details").show().css("right",0).attr("data-opened",!0):$("#details").show().stop().animate({right:0,300:300}).attr("data-opened",!0);c.find("h2 .event-title").text(a.title);c.find("span.venue-name").text(a.venue.name||"");c.find("p.address").text(a.venue.location.street||
"");c.find("p.description").html(a.description||"");c.find("p.phone").text(a.venue.phone||"");a.venue.url&&(d=a.venue.url.indexOf("http://")<0?"http://"+a.venue.url:a.venue.url);c.find("p.site a").attr("href",d||"").text(d||"");c.find("h3 .date").text(this.formatDateTime(a));c.find(".twitter-share-button").attr("src",this.getTwitterIframeSrc(a));this.refreshFacebookLikeButton(a);c.find("img.photo").attr("src",a.flyer||a.venue.image||"/images/app/party-placeholder.png");c.find("a.photo-link").attr("href",
a.flyer||a.venue.image||"/images/app/party-placeholder.png").data("title",a.title);c.find(".source-data").text(a.source);$(".show-event-map").click();d={title:a.title,lat:a.venue.location.geo_lat,lon:a.venue.location.geo_lon,type:a.evt_type};d={markers:[d],mapCenter:new google.maps.LatLng(d.lat,d.lon),targetElement:".details-map"};NOITEHOJE.webApp.googleMaps.setupMap(d);return c.find("span.event-type-icon").removeClass("party").removeClass("show").addClass(a.evt_type)},closeDetailsPanel:function(){$("#listings li").removeClass("current");
$("#details").stop().animate({right:-600,200:200}).attr("data-opened",!1);return setTimeout("$('#details').hide()",200)},getEventDetails:function(a){return $.getJSON(""+location.protocol+"//"+location.host+"/geteventjson/"+a)}}}();$(function(){$("a[rel^='prettyPhoto']").prettyPhoto({theme:"dark_rounded",social_tools:!1,opacity:0.5,markup:"        <div class='pp_pic_holder'>          <div class='pp_top'>            <div class='pp_left'></div>            <div class='pp_middle'></div>            <div class='pp_right'></div>          </div>          <a class='pp_close' href='#'>\u00d7 fechar</a>          <div class='pp_content_container'>            <div class='pp_left'>              <div class='pp_right'>                <div class='pp_content'>                  <div class='pp_loaderIcon'></div>                  <div class='pp_fade'>                    <a href='#' class='pp_expand' title='Expand the image'>Expand</a>                    <div class='pp_hoverContainer'>                      <a class='pp_next' href='#'>next</a>                      <a class='pp_previous' href='#'>previous</a>                    </div>                    <div id='pp_full_res'></div>                    <div class='pp_details'>                      <div class='ppt'>&nbsp;</div>                      <div class='pp_nav'>                        <a href='#' class='pp_arrow_previous'>Previous</a>                        <p class='currentTextHolder'>0/0</p>                        <a href='#' class='pp_arrow_next'>Next</a>                      </div>                      <p class='pp_description'></p>                    </div>                  </div>                </div>              </div>            </div>          </div>          <div class='pp_bottom'>            <div class='pp_left'></div>            <div class='pp_middle'></div>            <div class='pp_right'></div>          </div>        </div>        <div class='pp_overlay'></div>"});
$("a.photo-link").click(function(){var a,b;a=$(this);b=a.find("img").attr("src");if(b==="/images/app/party-placeholder.png")return!1;return $.prettyPhoto.open(b,a.data("title"),"")});$("#details").attr("data-opened",!1);$(".tabs-control li").click(function(a){a.preventDefault();$(".tabs-control li").removeClass("current");a=$(this).attr("class");$(this).addClass("current");$("#details").find("p.description, .details-map, .details-ppl-checkd-in, .details-comments").hide();if(a==="show-event-map")return $("#details .details-map").show();
else if(a==="show-event-description")return $("#details p.description").show();else if(a==="show-ppl-checkd-in")return $("#details .details-ppl-checkd-in").show();else if(a==="show-comments")return $("#details .details-comments").show()});$("#listings li .vevent").live("click",function(a){var b;a.preventDefault();$("#listings li").removeClass("current");a=$(this).parent().addClass("current").end().attr("id");b=$(this);b.find(".event_loader").show();return NOITEHOJE.webApp.eventDetails.getEventDetails(a).success(h(function(a){NOITEHOJE.webApp.location.updatePageTitle(a);
NOITEHOJE.webApp.eventDetails.openEventDetailsPanel(a);return NOITEHOJE.webApp.location.updateLocationForEventDetails(b.attr("href"))},this)).complete(h(function(){return b.find(".event_loader").hide()},this))});return $("#details a.close-panel, #listings .current").click(function(a){a.preventDefault();NOITEHOJE.webApp.eventDetails.closeDetailsPanel();NOITEHOJE.webApp.location.updateLocationForEventDetails();NOITEHOJE.webApp.googleMaps.unselectCurrentMarker();return NOITEHOJE.webApp.location.updatePageTitle()})});
$(function(){window.fbAsyncInit=function(){return FB.init({appId:NOITEHOJE.webApp.facebookAppId,status:!0,cookie:!0,xfbml:!0})};FB.Event.subscribe("auth.login",function(){});$.browser.msie&&$("body").addClass("msie");e();$(window).bind("resize",e);$(".view-scope a").click(function(a){var b;a.preventDefault();$(".view-scope a").removeClass("selected");$(this).addClass("selected");b=$(this).data("view-scope");a="Eventos";b==="any"?$(".vevent").show():(a=b==="party"?"Festas":"Shows",$(".vevent[data-event-type!='"+
b+"']").hide(),$(".vevent[data-event-type='"+b+"']").show());NOITEHOJE.webApp.location.listingEventTypes=a;NOITEHOJE.webApp.location.updatePageTitle();return NOITEHOJE.webApp.location.updateLocationWithScope(b)});$("#about").click(function(a){a.preventDefault();NOITEHOJE.webApp.location.updateLocationWithScope("about");return $("#modal-window").fadeIn(500)});$(".close-modal").click(function(a){a.preventDefault();NOITEHOJE.webApp.location.updateLocationWithScope("");return $("#modal-window").fadeOut(200)});
$(".view-type a").click(function(a){a.preventDefault();a=$(this).data("view-type");$(".view-type a").removeClass("current");$(this).addClass("current");$("#listings").removeClass("small-list").removeClass("large-list").removeClass("map-view");return a==="map-view"?NOITEHOJE.webApp.googleMaps.displayEventsMap():(NOITEHOJE.webApp.location.updateLocationWithScope(""),$("#listings").show().addClass(a),$(".view-dropdown, .view-scope").show(),$("#map_wrapper").hide())});$(".user-panel").click(function(){return $(".services-dropdown").show()});
setTimeout(function(){return $(".flash").fadeOut()},3E3);return $("body").click(function(a){$(a.target).parents(".view-dropdown").length===0&&$(".change-dropdown:visible").hide();$(a.target).parents(".login").length===0&&$(".login-dropdown:visible").hide();if($(a.target).parents(".user-panel").length===0)return $(".services-dropdown:visible").hide()})});e=function(){var a;a=$(window).height()-88;return $("#details").height(a)}}).call(this);
